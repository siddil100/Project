{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Package</title>
    
    <!-- ======= Styles ====== -->
    <link rel="stylesheet" href="{% static 'css/styleadmin.css' %}">
    
    

    
<style>
    /* CSS */
.custom-select {
     /* Set the width to 100% or adjust as needed */
    padding: 10px; /* Add padding to make it look more like a dropdown */
    background-color: #f5f5f5; /* Background color */
    border: 1px solid #ccc; /* Border style */
    border-radius: 5px; /* Rounded corners */
    color: #333; /* Text color */
}

.custom-option {
    font-weight: normal; /* Remove the bold font weight for options */
}

/* Style for the selected (disabled) option */
.custom-select option:disabled {
    color: #888; /* Grayed-out color for the placeholder option */
}

/* Style for when the select box is open (active) */
.custom-select:focus {
    border-color: #007BFF; /* Highlight border color when active */
}
</style>
<style>
    /* CSS for the "View More" link with hard yellow color */
    .view-more-link {
        text-decoration: none; /* Remove the default underline */
        background-color: #FFFF00; /* Hard yellow background color */
        color: #333; /* Text color (you can adjust this color to your preference) */
        padding: 5px 10px; /* Padding around the link text */
        border-radius: 3px; /* Rounded corners */
        transition: background-color 0.2s, color 0.2s; /* Add a smooth transition effect */
    }
    
    .view-more-link:hover {
        background-color: #FFD700; /* Change background color on hover to a slightly darker yellow */
    }
    






   
    
    h2 {
        color: #333;
    }
    form {
        margin-top: 20px;
    }
    label {
        display: block;
        margin-bottom: 5px;
    }
    input[type="text"],
    input[type="number"],
    select {
        width: 100%;
        padding: 10px;
        margin-bottom: 15px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
    }
    button[type="submit"] {
        padding: 10px 20px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    button[type="submit"]:hover {
        background-color: #0056b3;
    }

    
        .error-message {
            color: red;
        }
    
    
</style>
</head>

<body>
    <!-- =============== Navigation ================ -->
    <div class="container">
        <div class="navigation">
            <ul>
                <li>
                    <a href="#">
                        <span class="icon"></span>
                        <span class="title">DreamWed</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'myadmin:myadmin' %}">
                        <span class="icon">
                            <ion-icon name="home-outline"></ion-icon>
                        </span>
                        <span class="title">Dashboard</span>
                    </a>
                </li>
                
                <li>
                    <a href="{% url 'myadmin:view_premium' %}">
                        <span class="icon">
                            <ion-icon name="star"></ion-icon>
                        </span>
                        <span class="title">View Premium Users</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'myadmin:aadharsus' %}">
                        <span class="icon">
                            <ion-icon name="document"></ion-icon>
                        </span>
                        <span class="title">Aadhaar Details</span>
                    </a>
                </li>
                
                <li>
                    <a href="{% url 'myadmin:destadmin' %}">
                        <span class="icon">
                            <ion-icon name="heart"></ion-icon>
                        </span>
                        <span class="title">Destination Wedding</span>
                    </a>
                </li>

                <li>
                    <a href="{% url 'myadmin:change_password_admin' %}">
                        <span class="icon">
                            <ion-icon name="lock-closed-outline"></ion-icon>
                        </span>
                        <span class="title">Password</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'accounts:logout' %}">
                        <span class="icon">
                            <ion-icon name="log-out-outline"></ion-icon>
                        </span>
                        <span class="title">Sign Out</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- ========================= Main ==================== -->
        <div class="main">
            <div class="topbar">
                <div class="toggle">
                    <ion-icon name="menu-outline"></ion-icon>
                </div>
                <div class="search">
                    <label>
                        <h1 style="font-size: 28px; margin-bottom: 5px; color: #0514f0; font-family: Arial, sans-serif;">DreamWed Admin Panel</h1>
                    </label>
                </div>
                <div class="user">
                    
                </div>
            </div>

            <!-- ======================= Cards ================== -->
            
            <!-- ================ Order Details List ================= -->
            <div class="details">
                <div class="recentOrders">
                    <div class="cardHeader">
                        <h2>Destination Wedding</h2>
                    </div>
                    
                    
                    <div class="cardHeader">
                        <h2>Add a Package</h2>
                    </div>
                    <form method="post" enctype="multipart/form-data" id="packageForm">
                        {% csrf_token %}
                        <label for="id_package_name">Package Name:</label>
                        <input type="text" name="package_name" id="id_package_name">
                        <small id="package_error" style="color: red;"></small>
                        <br>
                        <label for="id_star_rating">Star Rating:</label>
<select name="star_rating" id="id_star_rating" required>
  <option value="">Select Rating</option> <!-- Empty option for default -->
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
</select>

                        <br>
                        <label for="id_meal_preference">Meal Preference:</label>
                <select name="meal_preference" id="id_meal_preference" required>
                    <option value="">Select preference</option>  <!-- Default option -->
                    {% for preference in form.meal_preference.field.queryset %}
                        <option value="{{ preference }}">{{ preference }}</option>
                    {% endfor %}
                </select>
                
                        <br>
                        <label for="id_subcategory">Subcategory:</label>
                <select name="subcategory" id="id_subcategory" required>
                    <option value="">Select subcategory</option>  <!-- Default option -->
                    {% for subcat in form.subcategory.field.queryset %}
                        <option value="{{ subcat }}">{{ subcat }}</option>
                    {% endfor %}
                </select>




                <br>
                        <label for="id_dectype">Decoration Type:</label>
                <select name="dectype" id="id_dectype" required>
                    <option value="">Select decoration type</option>  <!-- Default option -->
                    {% for dtype in form.dectype.field.queryset %}
                        <option value="{{ dtype }}">{{ dtype }}</option>
                    {% endfor %}
                </select>
                
                        <br>
                        <label for="id_subtype">Decoration Subtype:</label>
                        <select name="subtype" id="id_subtype" required>
                            <option value="">Select decoration subtype</option>  <!-- Default option -->
                            {% for stype in form.subtype.field.queryset %}
                                <option value="{{ stype }}">{{ stype }}</option>
                            {% endfor %}
                        </select>
                        
                        <br>
                
                        <br>
                        <label for="id_attendees">Attendees:</label>
                <select name="attendees" id="id_attendees" required>
                    <option value="">Select attendees</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
                
                        <br>
                        <label for="days_count">Days Count:</label>
<select name="days_count" id="id_days_count">
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7" selected>7</option> <!-- Default selection -->
</select>

                        <br>
                        <label for="id_program_count">Program Count:</label>
                        <select name="program_count" id="id_program_count">
                          <option value="1">1</option>
                          <option value="2">2</option>
                          <option value="3">3</option>
                          <option value="4">4</option>
                          <option value="5">5</option>
                          <option value="6">6</option>
                          <option value="7" selected>7</option> <!-- Default selection -->
                          <option value="8">8</option>
                          <option value="9">9</option>
                          <option value="10">10</option>
                          
                        </select>
                        <br>
                        <label for="id_price">Price (Based on Food and Decoration):</label>
                <input type="text" name="price" id="id_price" readonly>
                
                        <br>
                        <label for="id_image">Image:</label>
                        <input type="file" name="image" id="id_image" required>
                        <br>
                        
                        <label for="id_location">Location:</label>
                        <select name="location" id="id_location" required>
                          <option value="">Select Location</option> <!-- Empty option for default -->
                          <option value="Thiruvananthapuram">Thiruvananthapuram</option>
                          <option value="Kollam">Kollam</option>
                          <option value="Pathanamthitta">Pathanamthitta</option>
                          <option value="Alappuzha">Alappuzha</option>
                          <option value="Kottayam">Kottayam</option>
                          <option value="Idukki">Idukki</option>
                          <option value="Ernakulam">Ernakulam</option>
                          <option value="Thrissur">Thrissur</option>
                          <option value="Palakkad">Palakkad</option>
                          <option value="Malappuram">Malappuram</option>
                          <option value="Kozhikode">Kozhikode</option>
                          <option value="Wayanad">Wayanad</option>
                          <option value="Kannur">Kannur</option>
                          <option value="Kasaragod">Kasaragod</option>
                        </select>
                        

                        
                        <button type="submit">Save Package</button>
                    </form>
                    
                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            const categorySelect = document.getElementById('id_meal_preference');
                            const subcategorySelect = document.getElementById('id_subcategory');
                        
                            categorySelect.addEventListener('change', function() {
                                const selectedCategory = categorySelect.value;
                                fetch("{% url 'myadmin:get_subcategories' %}?category=" + selectedCategory)
                                .then(response => response.json())
                                .then(data => {
                                    subcategorySelect.innerHTML = ''; // Clear previous options
                                    data.forEach(subcat => {
                                        const option = document.createElement('option');
                                        option.value = subcat.subcategory;
                                        option.textContent = `${subcat.subcategory} (${subcat.name})`; // Display name in brackets
                                        subcategorySelect.appendChild(option);
                                    });
                                })
                                .catch(error => console.error('Error fetching subcategories:', error));
                            });
                        });
                        
                
                
                
                
                
                
                
                        document.addEventListener('DOMContentLoaded', function() {
                            const typeSelect = document.getElementById('id_dectype');
                            const subtypeSelect = document.getElementById('id_subtype');
                        
                            typeSelect.addEventListener('change', function() {
                                const selectedType = typeSelect.value;
                                fetch("{% url 'myadmin:get_decoration_subtypes' %}?decoration_type=" + selectedType)
                                    .then(response => response.json())
                                    .then(data => {
                                        subtypeSelect.innerHTML = ''; // Clear previous options
                                        data.forEach(subtype => {
                                            const option = document.createElement('option');
                                            option.value = subtype;
                                            option.textContent = subtype;
                                            subtypeSelect.appendChild(option);
                                        });
                                    })
                                    .catch(error => console.error('Error fetching decoration subtypes:', error));
                            });
                        });
                        
                
                
                
                
                
                        document.addEventListener('DOMContentLoaded', function() {
                            const subcategorySelect = document.getElementById('id_subcategory');
                            const subtypeSelect = document.getElementById('id_subtype');
                            const attendeesSelect = document.getElementById('id_attendees');
                            const priceInput = document.getElementById('id_price');
                        
                            // Event listeners for changes in subcategory, subtype, and attendees
                            subcategorySelect.addEventListener('change', fetchAndCalculatePrice);
                            subtypeSelect.addEventListener('change', fetchAndCalculatePrice);
                            attendeesSelect.addEventListener('change', fetchAndCalculatePrice);
                        
                            function fetchAndCalculatePrice() {
                                const subcategoryValue = subcategorySelect.value;
                                const subtypeValue = subtypeSelect.value;
                                const attendeesValue = attendeesSelect.value;
                        
                                // Fetch prices from the server using AJAX
                                fetch("/myadmin/api/get-price/?subcategory=" + subcategoryValue + "&subtype=" + subtypeValue)
                    .then(response => response.json())
                    .then(data => {
                        const subcategoryPrice = parseFloat(data.subcategory_price);
                        const subtypePrice = parseFloat(data.subtype_price);
                        const attendees = parseFloat(attendeesValue);
                
                        // Calculate total price based on fetched prices and attendees
                        const totalPrice = subcategoryPrice * subtypePrice * attendees;
                        if (!isNaN(totalPrice)) {
                            priceInput.value = totalPrice.toFixed(2); // Set the calculated price in the input field
                        } else {
                            priceInput.value = ''; // Clear the price if calculation fails
                        }
                    })
                    .catch(error => console.error('Error fetching prices:', error));
                
                            }
                        });
                        




                        
                    </script>
                        
                    <script>
  const packageNameInput = document.getElementById('id_package_name');
  const packageError = document.getElementById('package_error');

  packageNameInput.addEventListener('input', function() {
    let packageName = this.value.trim();
    let isValid = /^[a-zA-Z ]{3,16}$/.test(packageName);
    if (isValid) {
      packageError.textContent = ''; // Clear error message
    } else {
      packageError.textContent = 'Package name must contain only letters and spaces, with a length between 3 and 16 characters.';
    }
  });
</script>
                </div>
            </div>
        </div>
        <!-- ================= New Customers ================ -->
    </div>

    

    <!-- =========== Scripts =========  -->
    <script src="{% static 'js/mainadmin.js' %}"></script>


    

    <!-- ====== ionicons ======= -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
</body>
</html>
